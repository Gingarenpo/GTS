---
title: 'GTS - Ginren Traffic System'
subtitle: 'モデルパック・データ仕様書'
date: "2025/06/04"
author: 
    - 銀河連邦
company: "株式会社 銀連製作所"
---

# はじめに

この文書は、GTS - Ginren Traffic System（以降、GTSとします。）で適用することのできる拡張モデルパック（以下、拡張パックあるいはパックとします）の作成方法（仕様）、及び交通信号制御機等を始めとする各種データの仕様について記載しています。

この文書はユーザーガイドライン・マニュアルとしては作成されていません。パックを作成するつもりがなく、単にGTSを利用したいだけの場合は、こちらではなく別途用意しているユーザー向けマニュアルをお読みください。

開発に伴いなるべく仕様書も最新に整えるようにするつもりですが、仕様書と現況に差異が生じる場合があります。また、バージョンは最新版を想定していますが、過去のバージョンから修正・削除されたものなどについてはその旨を明記するとします。

画像が不足していますがおいおい追加します。また、この文書はマークダウンを自動変換して作成しているため、ところどころお見苦しい点がありますがご了承ください。

# パックについて

GTS内で追加される各交通機器（一部例外を除きます）において、ユーザーが独自に作成したモデル等を適用することができます。その際、決められた形式に従って「パック」を作成する必要があります。このパックは、RealTrainMod（RTM）のモデルパックに相当するもので、こちらの作成経験がある場合は概ねその知識が活かせると思います。ただし互換性はありません（ファイル形式などは同一ですが）。

中身はZIPファイルなので誰でも作成できます。スマートフォンでも頑張れば作れます。

## パックでは何が変更できるのか

GTSにパックを適用すると、例えば以下のような変更が可能となります。

- ほぼすべての交通機器（信号機、制御機、押ボタン箱など）のモデル（見た目）を変更することができます。
- 押ボタン箱等の場合、必要に応じて自前の音声を流すことができます。
- （現時点未対応：上級者向け）Javaのクラスを追加することで、GTSそのものの仕組みを一部変更することができます。

## パックに含むことのできるファイル

GTSが認識できるファイルとしては、以下のものに限られます。

### モデリングファイル（3Dオブジェクト）

現在、`MQOファイル`（Metasequoiaで作成できるもの）のみ対応しています。Metasequoia 4.xの形式に準拠しており、読み込みとしては「マテリアル」「オブジェクト」「テクスチャUV」「スムージング角度」のパラメータを読み込むことができます。

MQOファイルをお持ちでない方（UnityだとFBX、他にはobjなど）は、お手数ですがMQOファイルに変換の上ご利用ください。

### テクスチャファイル

GTSでは、`png`形式を推奨していますが、`jpg`形式も読み取ることができます。というより、内部では`ImageIO`を呼び出しているだけなので、これが対応している形式であれば何でも読み取ることができます。

### 音声ファイル

Minecraftの制約上、`OGGファイル`のみに対応しています。`MP3`や`WAV`等をお持ちの方は、`Audacity`等をダウンロードしてご利用いただくと変換が可能です。多分、コーデックは何でも対応しているんじゃないかと思っていますが、読み取れなかったらコーデック部分を見直してみてください。

### JSONファイル

各モデルの設定ファイルを記載するためのものとなります。JSONが分からない方はそもそも話になりませんので、検索して学習して下さい。ここでは説明は割愛します。

### gts.txt

テキストファイルとして含めることのできる唯一のファイルで、大文字小文字を含めてこのファイル名で統一する必要があります。メタデータを格納する場所ですが、詳しくは後述します。

---

これ以外のファイルもパックに含めることはできますが、GTSで読み込む際には無視されます。逆にいえば、不要なファイルが入っていてもGTSは問題なくパックを認識します。

# パックの作り方

注意：ここで紹介している`GTS Pack Maker`は、2025年6月9日時点で開発中です。

GTSでは、パックを少しでも作り易く、管理しやすくするために`GTS Pack Maker`というパック管理ツールを使用することができます。こちらに沿って作っていただければ、確実に仕様に即したものができあがります。このツールは、ダウンロードしたjarファイルをダブルクリックすることで実行できます。詳しい使い方については、別途用意しているツール用マニュアルをご覧ください。

ここでは、GTSパックとして認められるために必要な手順をざっくり掲載します。

## ワーキングディレクトリを作成する

パックのファイル群を格納するため、どこでもいいのでワーキングディレクトリを作成しましょう。パックに使用するファイルは全てこのディレクトリの中に置くようにしてください。このディレクトリの中であれば、いくらでも階層に分けて整理して問題ありません。好きなところにファイルを置いてください。

なお、ここに置くファイルは原則半角英数字とアンダーバーのみで名前を決めることを強くお勧めします。マルチバイト文字（全角）を入れると想定しない動きを取る場合があります（特に音声ファイルはほぼ100％読み込みに失敗します）。

## モデルを作る

お好きなモデリングソフトウェアを使用して、3Dモデルを作成してください。なお、3Dモデルは比較的自由に作成頂けますが、適用する交通機器によっては追加の制約が課せられることがあります。共通で推奨すべき項目について、以下に記します。

### ファイル形式

ファイル形式は前章の通り、`MQOファイル`のみを使用することができます。どのようなモデリングソフトウェアを使用していただいても構いませんが、必ずMQOファイルでの出力を行ってください。以下、MQOファイルであること、Metasequoiaを使用していること前提で記載します。

### サイズ

サイズに関しては、この後のステップでJSONファイルを作成する際に指定できますので、ここでは特に意識する必要はありません。好きなサイズで作成してください。ただし、極端に小さなサイズで作成すると、リサイズ時の計算に誤差が生じてモデルの形状が破綻する恐れがあります。最大・最小頂点が小数点第3位くらいまでに収まるようにすレ場問題ないので、たいていの場合問題にはなりません。

### 座標（位置）

基本的に設置時は強制的に原点中心に移動しますのでどの位置に作成していただいても構いませんが、モデリングの際は原点中心で行うことをお勧めします。というのも、ミラーリングなどを使用する場合はおのずと原点中心のほうがやりやすいと思います。

意図的にモデルをずらしたい場合はコンフィグファイルでデフォルトの描画位置を指定することができます。

### テクスチャ

テクスチャは`UV`を使用してマッピングしてください。UVマッピングは`0`～`1`の間で座標指定されるので、あまり細かく指定すると破綻するかもしれません（小数点第6位くらいまでは平気です）。`平面`や`曲面`などといった指定もありますがこちらは未対応です。必ず`UV`で設定してください。また、**すべての面に対して**UVを割り当ててください。UVが貼られていない面が存在する場合、描画に失敗することがあります。

GTSで使用できるテクスチャは原則1枚（信号機などを除く）なので、すべての面のテクスチャは1つのテクスチャに収める必要があります。テクスチャのファイルパスはコンフィグファイルで定めますので、モデリングの際にはどこにいようと構いません。

### 面

4.x以降のMetasequoiaでは、多角形の面を扱うことができます。GTSでは、**三角面あるいは四角面**のみで作成することを強く推奨します。設計上は多角形の面も扱うことができるようにしていますが、動作確認を全く行っていないため多角形で面を作成したファイルを使用した場合についてはサポート対象外とさせていただきます。

デフォルトでは面は表面しか描画されませんので、表裏で面を別々に登録したい場合はなんかこういい感じに重ねてください。今後対応するかは未定です。

### オブジェクト

交通信号機、交通信号柱、アームなどはこのオブジェクトごとに描画の有無を判断します。オブジェクト名を変更して、適切にコンフィグを書けるように整理してください。Metasequoia4.xからは階層化もできますが、階層化してもGTS読み込み時には（多分）すべて無視します。

オブジェクト名はいらない事故を避けるため、半角英数字で構成することを強くお勧めします。また、交通信号制御機はこのオブジェクト名を基準に光らせる現示を決定するため、各モデルパックではオブジェクト名を統一しておくとユーザーが使いやすくなります。

参考までに、交通信号機の場合、当社では以下のような命名規則を用いています。

|オブジェクト名|内容|
|-------------|----|
|body|現示と関係ない、常に描画されるもの。|
|(g\|y\|r)\[250\|300\]|各色のレンズ部分。ここが現示指定時に点灯する。例：g300→300mmの青|
|(g\|y\|r)\[normal\|dl\|dy\|over\]h|各色の庇。左から順に、`ノーマル` `ダブルフード（左穴）` `ダブルフード（右穴）` `筒型`|

制御機のサイクル情報を一緒に提供しない場合は、各現示がどのオブジェクトに対応しているかの説明や資料を同梱することでユーザーが理解しやすくなります。

---

ここまでできたら、モデルファイルをワーキングディレクトリ内に放り込みましょう。`models`というディレクトリを作ってその中に入れると整理しやすいです。

## テクスチャを放り込む

モデルには最低1枚のテクスチャが必要となります。テクスチャを作成し（モデルの作成時に使用したテクスチャで構いません）、`png`あるいは`jpg`（非推奨）形式にして、ワーキングディレクトリに放り込みます。

テクスチャのサイズは問いませんが、目安としては`1024`×`1024`以下となります。もちろん高画質なテクスチャを使用することもできますが、比例してメモリ使用量も上がるので注意してください。

Minecraftは描画にOpenGLを使用しており、その制約上テクスチャは**2の累乗**ピクセル四方で作成するとパフォーマンスが向上します。そうでなくても動きますができる限りこのサイズで作成することをお勧めします。よくわからない方は以下のどれかで作成してください。

- 16x16　…　Minecraftのデフォルトテクスチャがこのサイズ。ドット感強め。
- 32x32　…　解像度が圧倒的に足りないので、単色のモデルとか向き。
- 64x64　…　1つのテクスチャを全面で利用する場合はここが最小限。
- 128x128　…　遠目で見る分には問題ないが、近くに来るとすぐ粗が目立つ。
- 256x256　…　普通にプレイする分には特に問題ない。細部はやや粗が目立つ。
- 512x512　…　ここまで解像度があれば基本的にスクショにも耐えうる。
- 1024x1024　…　細かなレンズの模様や小さな文字などを再現したい場合に使用。メモリの使用量が若干多い。
- 2048x2048　…　これ以上は4Kとかで間近で見るとかしない限りオーバースペックとなる。

### なぜJPGは非推奨？

JPG（JPEG）ファイルは、テクスチャ1枚当たりの容量を大きく減らすことができるため、一見メモリの節約をできると思うかもしれません。ですが、OpenGLは結局展開すると（誤解を恐れずにざっくりいえば）ピクセル単位のデータに変換します。なのでPNGだろうがJPGだろうが使用するメモリの量は（サイズが同じなら）同等となります。JPGは容量を小さくする関係上`非可逆圧縮`という、画質が低下する処理を行っているため、テクスチャの画質が粗くなります。ならば初めからPNGつかっておけばいいよね、という話です。

余談ですがBMPも多分使えます。ただWindows専用でレガシーな保存方法のため使用しない方が吉です。

## （任意）音声ファイルを作成する

押ボタン箱、音響装置（現在開発予定段階）は、その機器が音声を出すことができます。その再生する音声ファイルを用意しましょう。信号機や制御機の場合はこのステップは不要です。

音声ファイルは`ogg`のみ対応しているので、この形式に変換してください。`Audacity`とか使用するのがおすすめです。

作成した後は、音声ファイルをワーキングディレクトリに放り込んでください。

## コンフィグファイルを作成する

各モデルとテクスチャ、音声ファイルを紐づける設定ファイルとして、`コンフィグファイル`を作成します。ここが一番パック制作初心者には難しいかと思われます。

JSON書式を使用して、JSONファイルを作成します。拡張子は小文字で`.json`とする必要があります。これ以外の拡張子はJSON書式で書いても読み込まれないので注意してください。

コンフィグファイルの中に記載するJSONキーと対応する値に関しては、次章で解説します。コンフィグファイルを作成できたらワーキングディレクトリに放り込んでください。

---

以上のステップを、必要な数だけ繰り返してください。

## （推奨）gts.txtを作成する

このファイルは、パックのメタ情報を入力するために作成されます。キーと値を`=`で結び、各プロパティを指定します（JavaのPropertiesと似た形式です）。ただしコメントは付与できません。

このファイルは任意で追加できますが、個人利用にとどまる場合などを除き入れておくことをお勧めします。特に、`name`と`author`は入れておくことで、バージョンアップに伴いパックが正常に読み込まれなくなることを防止します。

### 例

```properties
name=GTSTestPack
author=Gingarenpo

meta1=Hoge
meta2=Fuga
```

`name`に関しては、同一環境内においてかぶらない名称を付与してください。この名称がワールドの各交通機器に保存されるため、この名前を変更するとMissing状態になりダミーファイルに化けますのでご注意ください。このキーの指定がない、あるいはそもそもgts.txtを作成していない場合はデフォルトでZIPファイルから拡張子を除いた名前が使用されることになります。バージョンアップしたときに名前変わったりすることがあるので、`name`は必ず入れておいてください。

また`name`はリソースパックをダミーで用意する都合上、`ResourceLocation`の制約に伴って大文字箱文字に変換され、スペースは無効となります。なので、小文字の羅列で記載することをお勧めします。数字もOKですが先頭に追加することはできません。

`author`は現状使用されませんが将来的に使用する計画がありますので、可能なら入れておくことをお勧めします。こちらは全角表記でも構いません。

それ以外の情報も登録でき、そちらはメタデータとして扱われることになります。もしかしたらどこかで参照できるようになるかもしれませんが、現時点では特に使用箇所はありません。

## ZIP圧縮する

必要なファイルをワーキングディレクトリに全て放り込めたら、**ワーキングディレクトリに入ってから**ファイル・ディレクトリを全選択してZIPファイルに圧縮してください。**ワーキングディレクトリを**圧縮しないでください。

ZIP圧縮できたら、一度中身を確認してください。Windowsの場合はZIPファイルをダブルクリックすることで中身を見ることができます。

ZIPファイルを開いて最初に出てきた（ZIPファイル直下）ファイルやディレクトリが**ワーキングディレクトリの内部と**一致していることを確認してください。もし、ワーキングディレクトリそのものが入っている場合は、正しくZIP圧縮できていませんので、やり直してください。

ないとは思いますが暗号化すると開けなくなり落ちるので暗号化はしないでください。`7-Zip`を使用する場合、7z形式での圧縮は行わないでください。

---

これでパックが完成しました。あとは、このパックをお使いのMinecraftディレクトリの`mods/GTS`に入れて動作確認をしたり、配布したり煮たり焼いたりしてください。

# コンフィグの共通設定

コンフィグファイルは、原則以下のようなキーと値が含まれている必要があります。ただし、各交通機器によって使用が異なるものも存在しますので、その点については各交通機器の仕様をご覧ください。

なお、ファイルパスと記されているものは、ZIPファイル直下を基準とした相対パスで指定します。`models/test_model.mqo`のような形になります。先頭にスラッシュを付けないでください。

## 各キーと値の対応表

|設定項目名称|概要|備考|
|---|---|---|
|type|このコンフィグがどの交通機器の設定ファイルなのかを指定するもの。|文字列で指定。指定可能なものは`タイプ一覧`を参照|
|textures|このモデルが使用するテクスチャのファイルパスを指定する。中身はオブジェクトで、さらにその中にある`base`キーにファイルパスを指定する。|交通機器によって`base`以外の指定を行う必要があるものもある|
|id|このコンフィグの固有IDを文字列で指定する。|半角英数字で、**同一パック内で重複しないこと**。|
|model|モデルのファイルパスを指定する。||
|size（任意）|このモデルがワールドに設置されるときの大きさを、浮動小数で指定する。|単位はブロック。1.0と指定すると1ブロック分の大きさになる。このサイズは、最も長い辺がそのサイズになるように調整される。デフォルトは1.0のことが多いが指定することをお勧め|
|opacity（任意）|現在未使用。何を入れても無視される。|将来的に透明度の対応をするために予約しているもの|
|originalPosition（任意）|通常、モデルは原点基準で描画されるものをXYZ軸方向それぞれにどれだけずらすかを指定する。配列でXYZそれぞれを浮動小数で指定する。例：[0.0, 0.5, 0.0]|デフォルトはすべて0|

順番は問いません。ただし、`任意`と書かれているもの以外の全てのキーを必ず含むようにしてください。そうしないと読み込まれない場合があります。

## type一覧

`type`に入れるべき内容は以下となります。これ以外を入れると読み込まれません。

「未対応」と書いているものは実装していないので無視されます。

|項目名|交通機器|
|--|--|
|light|交通信号機|
|controller|交通信号制御機|
|button|押ボタン箱|
|pole|ポール|
|arm|アーム|
|sensor|感知器（現時点で未対応）|
|sound|音響装置（現時点で未対応）|
